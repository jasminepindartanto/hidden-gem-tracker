---
import MainLayout from "../../layouts/MainLayout.astro"; // WAJIB MainLayout

let errorMsg = "";

if (Astro.request.method === "POST") {
  const data = await Astro.request.formData();
  const password = data.get("password");

  if (password === "bandung-secret") {
    Astro.cookies.set("admin-session", "active", { path: "/", httpOnly: true });
    return Astro.redirect("/admin"); // Gunakan return
  } else {
    errorMsg = "Password salah!";
  }
}
---
<MainLayout title="Admin Gate" description="Authentication required">
  <div class="min-h-[60vh] flex items-center justify-center">
    <form method="POST" class="bg-slate-900 border border-slate-800 p-8 rounded-[40px] w-full max-w-md shadow-2xl">
      <h1 class="text-2xl font-bold text-white mb-6 text-center font-noto-serif">Admin Gate</h1>
      {errorMsg && <p class="text-red-400 text-xs font-bold mb-4 text-center">{errorMsg}</p>}
      <input 
        type="password" 
        name="password" 
        placeholder="Secret Key" 
        class="w-full bg-slate-800 border border-slate-700 rounded-2xl px-5 py-4 text-white focus:border-emerald-500 outline-none mb-4"
      />
      <button type="submit" class="w-full py-4 bg-emerald-500 text-slate-950 rounded-2xl font-bold hover:bg-emerald-400">
        Unlock Dashboard
      </button>
    </form>
  </div>
</MainLayout>